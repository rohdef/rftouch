<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">// Generated by CoffeeScript 1.3.3
<span id='RfTouch-data-ReloadStore'>/**
</span>  ReloadStore is an Store for automatically retrying when store data fails to 
  load. A small primitive, yet useful tool.
  
      @example
      Ext.define('Project.store.MyStore', {
        extend: 'RfTouch.data.ReloadStore',
        // Configure model, proxy etc as with a normal Sencha Touch 2 store
        
        retries: 2
      });
*/

Ext.define('RfTouch.data.ReloadStore', {
  extend: 'Ext.data.Store',
<span id='RfTouch-data-ReloadStore-property-_tries'>  _tries: 0,
</span>  config: {
<span id='RfTouch-data-ReloadStore-cfg-retries'>    /**
</span>      @cfg {Number} retries
      The amount of times it should keep retrying before presenting with the 
      fallback option.
    */

    retries: 3,
<span id='RfTouch-data-ReloadStore-cfg-listeners'>    listeners: {
</span>      load: 'retryLoad'
    }
  },
<span id='RfTouch-data-ReloadStore-method-retryLoad'>  retryLoad: function(store, records, success, operation, opts) {
</span>    if (!success) {
      if (store._tries &gt;= store.getRetries()) {
        return store.load();
      } else {
        return Ext.Msg.alert('Loading data failed', 'Press ok to try again.', store.resetAndReload, store);
      }
    }
  },
<span id='RfTouch-data-ReloadStore-method-resetAndReload'>  /**
</span>    Resets the retry counter and attempts to load it again.
    
    @param {RfTouch.data.ReloadStore} (optional) the store to reload, defaults 
    to this. Can be useful if you're having scoping problems.
  */

  resetAndReload: function(store) {
    if (store == null) {
      store = this;
    }
    store._tries = 0;
    return store.load();
  }
});
</pre>
</body>
</html>
